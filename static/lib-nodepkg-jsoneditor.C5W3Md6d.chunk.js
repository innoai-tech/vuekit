var Oe=e=>{throw TypeError(e)};var Xe=(e,i,t)=>i.has(e)||Oe("Cannot "+t);var C=(e,i,t)=>(Xe(e,i,"read from private field"),t?t.call(e):i.get(e)),Z=(e,i,t)=>i.has(e)?Oe("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,t);import{c as ie,I as V,j as n,a as $,r as h,s as I,b as Ye,d as w,e as ye,f as xe,T as Pe,F as Ge,o as H,t as Qe,g as Ze}from"./lib-nodepkg-vuekit.BNqaAJVf.chunk.js";import{J as U,o as et,g as tt,S,a as nt,b as ue,r as rt,s as it,E as at}from"./lib-nodepkg-typedef.CUo9Xxdg.chunk.js";import{s as y,a as ot,P as F,v as ae,b as oe,B as ct}from"./lib-nodepkg-vueuikit.D4KNpCNM.chunk.js";import{I as lt,a as A}from"./lib-nodepkg-vuematerial.BD4qh4cn.chunk.js";import{m as st,a as dt,b as ve,c as ge,d as De}from"./webapp-vuekit-layout.BxNW0wFi.chunk.js";import{O as Re,s as ce,m as K,f as L,d as te,t as b,E as le,c as ne,B as Le,S as ut}from"./vendor-rxjs.Bjk7X9ON.chunk.js";import{i as ht,g as ee,a as z,b as ft,s as Te,l as yt,c as pt,d as Be,e as mt}from"./vendor-innoai-tech-lodash.Dlm2YQgM.chunk.js";import{M as xt}from"./lib-nodepkg-vuemarkdown.BGVWTXm3.chunk.js";var P,_;const Se=class Se extends Re{constructor(t,r){super(a=>{const o=C(this,P).subscribe(a);return()=>{o.unsubscribe()}});Z(this,P,new V({}));Z(this,_,new V({}));this.typedef=t,this.initials=r,C(this,P).next(r)}static of(t,r){return new Se(t,r??(t.type=="array"?[]:{}))}isDirty(t,r){if(!ht(t)){const a=ee(this.initials,r);return z(a)||a!==t}return!1}update(t,r,a){if(C(this,_).next({}),t.length==0){C(this,P).next(r);return}ft(r)?C(this,P).next(o=>{const c=ee(o,t,a);r(c),Te(o,t,c)}):C(this,P).next(o=>{Te(o,t,r)})}delete(t){t.length!=0&&C(this,P).next(r=>{const a=yt(t);if(pt(a)){const d=t.slice(0,t.length-1),l=d.length>0?ee(r,d):r;if(Be(l)){l.splice(a,1);return}}const o=t.slice(0,t.length-1),c=o.length>0?ee(r,o):r;delete c[a]})}get error$(){return C(this,_)}setError(t,r){const a=U.create(t);C(this,_).next(o=>{r===null?delete o[a]:o[a]=r})}};P=new WeakMap,_=new WeakMap;let pe=Se;const B=ie(()=>new pe(et(),{})),q=ie(()=>({})),Me=y("span")({px:2,pos:"relative",display:"flex",alignItems:"center",gap:8,visibility:"hidden"}),se=y("span",({},{slots:e})=>i=>{var t;return n(i,{children:n(Me,{"data-visible-on-hover":!0,children:(t=e.default)==null?void 0:t.call(e)})})})({display:"flex"}),D=y(lt)({transition:"none",width:24,height:24,rounded:12,[`& ${A}`]:{svg:{width:18,height:18}}});class M extends V{static from(i){const t=new M(!1);return h(i,ce(r=>r?K(h(L(r,"focus"),b(()=>{t.show()})),h(L(r,"blur"),te(200),b(()=>{t.value&&t.hide()}))):le),I()),t}show(){this.next(!0)}hide(){this.next(!1)}}const vt=ot({apply({elements:e,rects:i}){Object.assign(e.floating.style,{width:`${i.reference.width}px`})}}),Je=$((e,{emit:i,slots:t,render:r})=>{const a=e.open$??new M(!1),o=c=>{const d=[c.target,...c.composedPath()].find(l=>{var f;return(f=l==null?void 0:l.hasAttribute)==null?void 0:f.call(l,"data-value")});if(d){const l=d.getAttribute("data-value");z(l)||(i("selected",l),a.hide())}};return h(a,r(c=>{var d,l,f;return n(F,{isOpen:c,onClickOutside:()=>a.hide(),onEscKeydown:()=>a.hide(),placement:"bottom-start",middleware:[vt],$content:n(We,{onClick:o,children:(d=t.content)==null?void 0:d.call(t)}),children:((f=(l=t.default)==null?void 0:l.call(t))==null?void 0:f[0])??null})}))});$((e,{slots:i,render:t})=>{const r=e.open$??new M(!1);return h(r,t(a=>{var o,c,d;return n(F,{isOpen:a,onClickOutside:()=>r.hide(),placement:"bottom-start",$content:n(We,{children:(o=i.content)==null?void 0:o.call(i)}),children:((d=(c=i.default)==null?void 0:c.call(i))==null?void 0:d[0])??null})}))});const We=y("div")({textStyle:"sys.body-small",pos:"relative",roundedBottom:"sm",containerStyle:"sys.surface-container-lowest",borderBottom:"1px solid",borderRight:"1px solid",borderLeft:"1px solid",borderColor:ae("sys.outline-variant",oe(.38))}),_e=y("div")({px:8,py:2,gap:8,display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"right",textStyle:"sys.body-small",cursor:"pointer",_hover:{containerStyle:"sys.surface-container"},_focus:{containerStyle:"sys.surface-container",outline:0}}),de=$((e,{slots:i,render:t})=>{const r=new M(!1);return h(r,t(a=>{var c;const o=(c=i.default)==null?void 0:c.call(i)[0];return n(F,{isOpen:a,placement:e.placement??"left",$content:n(bt,{children:n(gt,{children:i.title()})}),children:o?Ye(o,{onMouseover:()=>{r.show()},onMouseout:()=>{r.hide()}}):null})}))}),gt=y("div")({py:4,px:12,rounded:"xs",shadow:"3",textStyle:"sys.body-small",containerStyle:"sys.on-surface",pos:"relative",zIndex:100}),bt=y("div")({px:8}),re=y("span")({textStyle:"sys.label-small",fontWeight:"bold",fontFamily:"inherit",fontSize:12,lineHeight:24,wordBreak:"keep-all",whiteSpace:"nowrap",font:"code",opacity:.3}),W=$((e,{slots:i})=>()=>{var t;return w($t,{"data-deprecated":e.deprecated,"data-optional":e.optional,"data-nullable":e.nullable,children:[i.leading&&n(wt,{"data-visible-on-hover":!0,children:i.leading()}),(t=i.default)==null?void 0:t.call(i)]})}),wt=y(Me)({position:"absolute",ml:-28}),$t=y("div")({position:"relative",display:"flex",alignItems:"center",textStyle:"sys.label-small",fontWeight:"bold",fontFamily:"inherit",wordBreak:"keep-all",whiteSpace:"nowrap",border:"1px solid",borderColor:"rgba(0,0,0,0)",fontSize:12,lineHeight:24,_deprecated:{textDecoration:"line-through"},_optional:{"&:after":{content:'"?"',color:"sys.secondary",opacity:.58}}}),Ct=y("div")({position:"absolute",zIndex:1,left:0,opacity:.58,fontSize:10,lineHeight:10,top:0,"& > *":{display:"flex",alignItems:"center",gap:4,"&::before":{content:'"// "',font:"code"}}}),ze=y("div")({display:"block",fontSize:10,lineHeight:14,color:"sys.error"}),St=y("div")({position:"relative",py:4,_hover:{containerStyle:"sys.surface-container","& [data-visible-on-hover]":{visibility:"visible"}},"&:focus-within":{containerStyle:"sys.surface-container"},_dirty:{bgColor:ae("sys.warning-container",oe(.38))},_error:{bgColor:"sys.error-container"},[`&:has(${se})`]:{[`& > ${ze}`]:{display:"none"},_error:{bgColor:"inherit"}}}),j=ie(()=>({indent:0,$container:ye(null)}),{name:"IntentContext"}),be=xe((e,{slots:i})=>{const t=j.use(),r=ye(null),a=ye(null);return()=>{var o,c,d;return w(Ge,{children:[n(re,{children:e.openToken}),(o=i.leading)==null?void 0:o.call(i),w(Pe,{to:t.$container.value,children:[w(Ot,{"data-indent":t.indent,children:[n(kt,{ref:r}),n(Tt,{ref:a}),a.value&&n(j,{value:{$container:a,indent:1+(t.indent??0)},children:(c=i.trailing)==null?void 0:c.call(i)})]}),n(Fe,{style:{paddingLeft:`${t.indent*32}px`,display:"flex"},children:n(re,{children:e.closeToken})})]}),r.value&&n(j,{value:{$container:r,indent:1+(t.indent??0)},children:(d=i.default)==null?void 0:d.call(i)})]})}}),J=$((e,{slots:i,render:t})=>{const r=j.use(),a=B.use(),o=h(a.error$,t(c=>{var f;const d=U.create(e.path),l=!e.viewOnly&&!!c[d];return w(St,{"data-error":l,"data-dirty":e.dirty,style:{paddingLeft:`${r.indent*32}px`},children:[(e.title||e.description)&&n(Ct,{style:{paddingLeft:`${r.indent*32}px`},children:e.description?n(de,{$title:n(we,{children:n(xt,{text:e.description})}),children:w("div",{children:[e.title," ",n(A,{path:st})]})}):n("span",{children:e.title})}),n(Fe,{children:(f=i.default)==null?void 0:f.call(i)}),l&&n(ze,{children:`${c[d]}`})]})}));return()=>n(Pe,{to:r.$container.value,children:o})}),kt=y("div")({}),Ot=y("section")({}),Tt=y("div")({}),Fe=y("div")({display:"flex",alignItems:"start",pr:10}),we=y("span")({display:"block",textStyle:"sys.body-small","& p":{my:1,wordBreak:"keep-all",whiteSpace:"nowrap",opacity:.7},"& code":{wordBreak:"keep-all",whiteSpace:"nowrap"}}),It=y("form")({display:"flex",pos:"absolute",right:0,bottom:0,px:8});y("div")({display:"flex",flexDirection:"column",pos:"relative",textarea:{minW:400,outline:"none",border:"none",bg:"none",py:8,px:12}});y("div")({display:"flex",alignItems:"center",gap:8,pos:"relative",px:8,input:{outline:"none",border:"none",bg:"none",minWidth:"10vw",py:8,px:12},[`& ${It}`]:{pos:"relative",px:0}});var he,Ie;function At(){return Ie||(Ie=1,he=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var i=document.activeElement,t=[],r=0;r<e.rangeCount;r++)t.push(e.getRangeAt(r));switch(i.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":i.blur();break;default:i=null;break}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||t.forEach(function(a){e.addRange(a)}),i&&i.focus()}}),he}var fe,Ae;function Nt(){if(Ae)return fe;Ae=1;var e=At(),i={"text/plain":"Text","text/html":"Url",default:"Text"},t="Copy to clipboard: #{key}, Enter";function r(o){var c=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return o.replace(/#{\s*key\s*}/g,c)}function a(o,c){var d,l,f,k,m,u,x=!1;c||(c={}),d=c.debug||!1;try{f=e(),k=document.createRange(),m=document.getSelection(),u=document.createElement("span"),u.textContent=o,u.ariaHidden="true",u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",function(g){if(g.stopPropagation(),c.format)if(g.preventDefault(),typeof g.clipboardData>"u"){d&&console.warn("unable to use e.clipboardData"),d&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var s=i[c.format]||i.default;window.clipboardData.setData(s,o)}else g.clipboardData.clearData(),g.clipboardData.setData(c.format,o);c.onCopy&&(g.preventDefault(),c.onCopy(g.clipboardData))}),document.body.appendChild(u),k.selectNodeContents(u),m.addRange(k);var O=document.execCommand("copy");if(!O)throw new Error("copy command was unsuccessful");x=!0}catch(g){d&&console.error("unable to copy using execCommand: ",g),d&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(c.format||"text",o),c.onCopy&&c.onCopy(window.clipboardData),x=!0}catch(s){d&&console.error("unable to copy using clipboardData: ",s),d&&console.error("falling back to prompt"),l=r("message"in c?c.message:t),window.prompt(l,o)}}finally{m&&(typeof m.removeRange=="function"?m.removeRange(k):m.removeAllRanges()),u&&document.body.removeChild(u),f()}return x}return fe=a,fe}var Et=Nt();const Pt=tt(Et),$e=$((e,{})=>()=>n(de,{$title:"复制当前节点为 JSON 字符串",children:n(D,{type:"button",onClick:()=>Pt(JSON.stringify(e.value,null,2)),children:n(A,{path:dt})})}));class G extends Le{static from(i){const t=new G("");return h(i,ce(r=>r?h(L(r,"input"),b(a=>{t.next(a.target.value.trim())})):le),I()),t}}class Q extends ut{static from(i){const t=new Q;return h(i,ce(r=>r?K(h(L(r,"keypress"),b(a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),t.next({type:"COMMIT"}))})),h(L(r,"keydown"),b(a=>{switch(a.key){case"Tab":a.target.getAttribute("data-options")&&(a.preventDefault(),t.next({type:"SELECT",direction:1}));break;case"ArrowDown":a.target.getAttribute("data-options")&&(a.preventDefault(),t.next({type:"SELECT",direction:1}));break;case"ArrowUp":a.target.getAttribute("data-options")&&(a.preventDefault(),t.next({type:"SELECT",direction:-1}));break}})),h(L(r,"keyup"),b(a=>{a.key==="Escape"&&t.next({type:"CANCEL"})}))):le),I()),t}}var R;class He extends Re{constructor(){super(t=>{const r=C(this,R).subscribe(t);return()=>r.unsubscribe()});Z(this,R,new Le(null))}static sync(t,r){return h(K(h(t,b(a=>{a&&a==U.create(r.path())&&r.editing$.show()})),h(r.editing$,te(1),b(a=>{a||t.disable(r.path())})),h(ne([r.value$,t]),te(1),b(([a,o])=>{z(a)&&!o&&t.enable(r.path())}))),I())}enable(t){C(this,R).value||C(this,R).next(U.create(t))}disable(t){C(this,R).value===U.create(t)&&C(this,R).next(null)}}R=new WeakMap;const Ue=ie(()=>new He),me=$((e,{render:i})=>{const t=H(null),r=H(null),a=H(null),o=Q.from(a),c=G.from(a),d=Ue.use(),l=M.from(a),f=B.use();He.sync(d,{editing$:l,value$:e.value$,path:()=>e.ctx.path});const k=()=>{if(e.typedef.type==="enums"){const p=(S.schemaProp(e.typedef,"enum")??[]).indexOf(e.value);if(p>-1)return p}return 0},m=new V({index:k()}),u=()=>{c.next(""),l.hide()},x=()=>{u(),m.next({index:k()}),z(e.value)&&f.delete(e.ctx.path)},O=s=>{var v,N;if(e.typedef.type==="enums"){const E=S.schemaProp(e.typedef,"enum")??[];s??(s=E[m.value.index%E.length])}else s??(s=(v=a.value)!=null&&v.value?(N=a.value)==null?void 0:N.value:void 0);if(z(s)){f.delete(e.ctx.path);return}const[p,T]=e.typedef.validate(s,{coerce:!0});if(p){f.setError(e.ctx.path,p.message);return}f.update(e.ctx.path,T),u()};e.allowRawJSON&&h(c,b(s=>{const p=s.trim();if(p.startsWith("{")&&p.endsWith("}")||p.startsWith("[")&&p.endsWith("]"))try{const T=JSON.parse(p);f.update(e.ctx.path,T),u()}catch{f.setError(e.ctx.path,"无效的 JSON 字符串")}}),I()),h(o,b(s=>{switch(s.type){case"SELECT":m.next(p=>{p.index+=s.direction});break;case"COMMIT":O();break;case"CANCEL":x();break}}),I());let g;return h(K(h(r,Qe(s=>{if(s){const p=new ResizeObserver(T=>{var v;for(const N of T)N.contentBoxSize&&(g=(v=N.contentBoxSize[0])==null?void 0:v.blockSize)});return p.observe(s),()=>{p.disconnect()}}return()=>{}})),h(a,te(1),b(s=>{s&&(s==null||s.focus(),s.value&&(s.selectionStart=0,s.selectionEnd=s.value.length))})),h(a,ce(s=>{if(s){const p=g?g-2:s.getBoundingClientRect().height,T=v=>{v.style.height=`${p??0}px`,v.style.height=`${v.scrollHeight}px`};return setTimeout(()=>T(s)),K(h(L(s,"blur"),b(v=>{var N,E;v.relatedTarget&&((N=r.value)!=null&&N.contains(v.relatedTarget)||(E=t.value)!=null&&E.contains(v.relatedTarget))||(v.preventDefault(),O(s.value))})),h(L(s,"input"),b(v=>{T(v.target),c.next(v.target.value)})))}return le}))),I()),e.typedef.type=="enums"?h(ne([e.value$,l,m]),i(([s,p,{index:T}])=>{const v=S.schemaProp(e.typedef,"enum")??[],N=S.metaProp(e.typedef,"enumLabels")??[];return n(Y,{ref:r,onClick:()=>{l.show()},"data-type":typeof s,tabindex:0,children:p?n(Je,{onSelected:E=>{O(E)},open$:l,$content:n("div",{ref:t,children:v.map((E,ke)=>n(Rt,{"data-focus":T%v.length===ke,value:E,label:N[ke]}))}),children:n(X,{children:n("input",{value:s==null?"":`${s}`,ref:a,"data-options":!0})})}):n(Ne,{children:JSON.stringify(s)??"undefined"})})})):h(ne([e.value$,l]),i(([s,p])=>n(Y,{ref:r,onClick:()=>{l.show()},"data-type":typeof s,tabindex:0,onFocus:()=>{l.show()},children:p?n(F,{isOpen:!0,placement:"right-start",$content:w(Ce,{ref:t,children:[n(D,{type:"button",onClick:()=>o.next({type:"CANCEL"}),children:n(A,{path:ve})}),n(D,{type:"button",onClick:()=>o.next({type:"COMMIT"}),children:n(A,{path:ge})})]}),children:n(X,{children:n("textarea",{ref:a,rows:1,value:s==null?"":`${s}`})})}):n(Ne,{children:JSON.stringify(s)??"undefined"})})))}),Ce=y("div")({borderRight:"1px solid",borderTop:"1px solid",borderBottom:"1px solid",borderColor:ae("sys.outline-variant",oe(.38)),containerStyle:"sys.surface-container-lowest",roundedRight:"sm",display:"flex",px:2,py:0,ml:-4}),X=y("div")({width:"100%",maxWidth:"40vw",display:"flex",alignItems:"center",border:"1px solid",overflow:"hidden",borderColor:ae("sys.outline-variant",oe(.38)),opacity:.38,"&:hover":{opacity:1},"&:focus-within":{opacity:1},"& > textarea,input":{flex:1,rounded:"xs",containerStyle:"sys.surface-container-lowest",width:"100%",outline:"none",border:"none",px:8,py:0,m:0,fontSize:"inherit",color:"inherit",lineHeight:"inherit",overflow:"hidden",resize:"none","&[data-options]:focus":{roundedBottom:0}}}),Ne=y("div")({border:"1px solid",borderColor:"rgba(0,0,0,0)",maxWidth:"40vw",width:"100%",overflow:"hidden",textOverflow:"ellipsis",_hover:{textOverflow:"clip",whiteSpace:"normal",wordBreak:"break-all"}}),Y=y("div")({wordBreak:"keep-all",whiteSpace:"nowrap",cursor:"pointer",display:"flex",alignItems:"center",font:"code",width:"100%",textStyle:"sys.label-small",fontSize:12,lineHeight:24,gap:8,_type__string:{color:"sys.primary"},_type__number:{color:"sys.primary"},_type__boolean:{color:"sys.warning"},_type__undefined:{color:"sys.error"}}),Dt=y(_e)({[`& ${W}`]:{textAlign:"left"}}),Rt=xe(e=>()=>w(Dt,{"data-value":e.value,tabindex:0,children:[n(W,{children:e.value}),e.label&&n(we,{children:e.label})]})),je=$(({},{emit:e})=>()=>n(de,{$title:"删除属性",children:n(D,{type:"button",onClick:()=>e("remove"),children:n(A,{path:De})})})),Lt=$((e,{render:i})=>{const t=B.use(),r=q.use();return h(e.value$,i(a=>n(be,{openToken:"{",closeToken:"}",$leading:n(se,{children:n($e,{value:a})}),$trailing:n(Ve,{ctx:e.ctx,onAdd:o=>{t.update([...e.ctx.path,o],void 0)},options:[...e.typedef.entries(a,e.ctx)].filter(([o])=>!Object.hasOwn(a,o)).map(([o,c,d])=>({propName:String(o),typedef:d}))},"prop-input"),children:[...e.typedef.entries(a,e.ctx)].map(([o,c,d])=>{var f;if(!Object.hasOwn(a,o))return null;const l=[...e.ctx.path,o];return w(J,{path:l,dirty:t.isDirty(c,l),title:S.metaProp(d,"title"),description:S.metaProp(d,"description"),children:[n(W,{deprecated:S.schemaProp(d,"deprecated"),$leading:n(je,{onRemove:()=>{t.delete(l)}}),children:String(o)}),w(re,{children:[":"," "]}),(f=r.$value)==null?void 0:f.call(r,d,c,{...e.ctx,path:l,branch:[...e.ctx.branch,c]})]})})})))}),Ve=$((e,{emit:i,render:t})=>{const r=H(null),a=Q.from(r),o=G.from(r),c=M.from(r),d=B.use(),l=new V({index:0}),f=()=>{c.hide(),o.next(""),r.value&&(r.value.value="",r.value.blur()),l.next({index:0})};h(o,b(u=>{const x=u.trim();if(x.startsWith("{")&&x.endsWith("}"))try{const O=JSON.parse(x);d.update(e.ctx.path,O),f()}catch{d.setError(e.ctx.path,"无效的 JSON 字符串")}}),I());const k=u=>{var x;e.options?u??(u=(x=e.options[l.value.index%e.options.length])==null?void 0:x.propName):u??(u=o.value),u?(i("add",u),f()):d.setError([...e.ctx.path,S.RecordKey],"无效的属性值")};h(a,b(u=>{switch(u.type){case"SELECT":l.next(x=>{x.index+=u.direction});break;case"COMMIT":k();break;case"CANCEL":f();break}}),I());const m=h(c,t(u=>n(X,{children:n("input",{ref:r,type:"text",placeholder:"添加属性 (可粘贴 JSON 字符串)","data-options":u})})));return h(ne([o,c,l,e.options$]),t(([u,x,O,g])=>g?g.length>0?n(J,{path:e.ctx.path,children:n(Y,{sx:{mx:-4},children:n(Je,{onSelected:s=>{k(s)},open$:c,$content:n("div",{children:g.map((s,p)=>u&&!s.propName.includes(u)?null:n(Bt,{propName:s.propName,typedef:s.typedef,"data-focus":p===O.index%g.length}))}),children:m})})}):null:n(J,{path:[...e.ctx.path,S.RecordKey],children:n(Y,{sx:{mx:-4},children:n(F,{isOpen:x,placement:"right-start",$content:w(Ce,{children:[n(D,{type:"button",onClick:()=>a.next({type:"CANCEL"}),children:n(A,{path:ve})}),n(D,{type:"button",onClick:()=>a.next({type:"COMMIT"}),children:n(A,{path:ge})})]}),children:n(X,{children:n("input",{ref:r,type:"text",placeholder:"添加属性 (可粘贴 JSON 字符串)"})})})})})))}),Bt=xe(e=>()=>w(Mt,{"data-value":e.propName,tabindex:0,children:[n(W,{optional:S.schemaProp(e.typedef,S.optional),children:e.propName}),n(we,{children:S.metaProp(e.typedef,"title")})]})),Mt=y(_e)({[`& ${W}`]:{textAlign:"left"}}),Ke=$((e,{render:i})=>{const t=B.use(),r=q.use();return h(e.value$,i(a=>n(be,{openToken:"[",closeToken:"]",$leading:n(se,{children:n($e,{value:a})}),$trailing:n(Jt,{ctx:e.ctx,typedef:e.typedef,onAdd:o=>{t.update(e.ctx.path,c=>{c.push(o)},[])}}),children:[...e.typedef.entries(a,e.ctx)].map(([o,c,d])=>{var f;const l=[...e.ctx.path,o];return w(J,{path:l,dirty:t.isDirty(c,l),children:[n(W,{$leading:n(Wt,{onRemove:()=>{t.delete(l)}}),children:n(ct,{sx:{opacity:.3,mr:"0.5em"},children:String(o)})}),(f=r.$value)==null?void 0:f.call(r,d,c,{...e.ctx,path:l,branch:[...e.ctx.branch,c]})]})})})))}),Jt=$((e,{emit:i,render:t})=>{const r=H(null),a=G.from(r),o=Q.from(r),c=M.from(r),d=B.use(),l=()=>{r.value&&(r.value.value="",r.value.blur())},f=m=>{if(m??(m=a.value),m){const u=S.schemaProp(e.typedef,"items"),[x,O]=u.validate(m,{coerce:!0});if(x){d.setError(e.ctx.path,x);return}i("add",O)}else i("add",void 0);l()};h(a,b(m=>{const u=m.trim();if(u.startsWith("[")&&u.endsWith("]"))try{const x=JSON.parse(u);d.update(e.ctx.path,x),l()}catch{d.setError(e.ctx.path,"无效的 JSON 字符串")}if(u.startsWith("{")&&u.endsWith("}"))try{f(JSON.parse(u))}catch{d.setError(e.ctx.path,"无效的 JSON 字符串")}}),I()),h(o,b(m=>{switch(m.type){case"COMMIT":f();break;case"CANCEL":l();break}}),I());const k=h(c,t(m=>n(F,{isOpen:m,placement:"right-start",$content:w(Ce,{children:[n(D,{type:"button",onClick:()=>o.next({type:"CANCEL"}),children:n(A,{path:ve})}),n(D,{type:"button",onClick:()=>o.next({type:"COMMIT"}),children:n(A,{path:ge})})]}),children:n(X,{children:n("input",{ref:r,type:"text",placeholder:"添加数组项 (可粘贴 JSON 字符串)"})})})));return()=>n(J,{path:e.ctx.path,children:n(Y,{sx:{mx:-4},children:k})})}),Wt=$(({},{emit:e})=>()=>n(de,{$title:"移除项",children:n(D,{type:"button",onClick:()=>e("remove"),children:n(A,{path:De})})})),qe=$((e,{render:i})=>{const t=B.use(),r=q.use();return h(e.value$,i(a=>n(be,{openToken:"{",closeToken:"}",$leading:n(se,{children:n($e,{value:a})}),$trailing:n(Ve,{ctx:e.ctx,onAdd:o=>{t.update([...e.ctx.path,o],void 0)}},"prop-input"),children:[...e.typedef.entries((()=>{const o={};for(const c of Object.keys(a??{}).toSorted())o[c]=a==null?void 0:a[c];return o})(),e.ctx)].map(([o,c,d])=>{var f;if(!Object.hasOwn(a,o))return null;const l=[...e.ctx.path,o];return w(J,{path:l,dirty:t.isDirty(c,l),children:[n(W,{$leading:n(je,{onRemove:()=>{t.delete(l)}}),children:String(o)}),w(re,{children:[":"," "]}),(f=r.$value)==null?void 0:f.call(r,d,c,{...e.ctx,path:l,branch:[...e.ctx.branch,c]})]})})})))}),_t=$((e,{render:i})=>h(e.value$,i(t=>Be(t)?n(Ke,{value:t,typedef:nt(ue()),ctx:e.ctx}):mt(t)?n(qe,{value:t,typedef:rt(it(),ue()),ctx:e.ctx}):n(me,{value:t,typedef:ue(),ctx:e.ctx,allowRawJSON:!0})))),Ee=(e,i,t)=>e.type=="object"||e.type=="intersection"||e.type=="union"&&S.schemaProp(e,"discriminator")?n(Lt,{typedef:e,value:i??{},ctx:t}):e.type=="union"&&z(S.schemaProp(e,"discriminator"))?n(me,{typedef:e,value:i,ctx:t}):e.type=="record"?n(qe,{typedef:e,value:i,ctx:t}):e.type=="array"?n(Ke,{typedef:e,value:i,ctx:t}):e.type=="any"||e.type=="unknown"?n(_t,{typedef:e,value:i,ctx:t}):n(me,{typedef:e,value:i,ctx:t}),Gt=$(({},{render:e})=>{const i=B.use(),t=q.use(),r=Ze(null);return h(i,e(a=>{const o=t.$value??Ee;return n(Ue,{children:n(q,{value:{$value:t.$value??Ee},children:w(zt,{children:[n("section",{ref:r}),r.value&&n(j,{value:{indent:0,$container:r},children:n(J,{path:[],viewOnly:!0,children:o(i.typedef,a,at)})})]})})})}))}),zt=y("div")({width:"100%",height:"100%",overflow:"auto",section:{display:"flex",flexDirection:"column",minWidth:"max-content"}});export{pe as J,B as a,Gt as b,Pt as c};
