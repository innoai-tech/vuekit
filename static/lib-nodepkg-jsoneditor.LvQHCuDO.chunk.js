var e,t,n,a;import{c as i,I as r,j as l,a as o,r as s,s as d,b as p,d as c,e as u,f as h,T as y,F as m,o as f,t as x,g as v}from"./lib-nodepkg-vuekit.DNOk4_iQ.chunk.js";import{J as b,o as g,g as w,S as N,a as C,b as k,r as S,s as $,E as O}from"./lib-nodepkg-typedef.BmYRT45X.chunk.js";import{s as E,a as I,P as T,v as A,b as D,B as R}from"./lib-nodepkg-vueuikit.CMdsXkh-.chunk.js";import{I as P,a as J}from"./lib-nodepkg-vuematerial.5q8nPJh6.chunk.js";import{m as L,a as M,b as B,c as _,d as W}from"./webapp-vuekit-layout.BUZZuOty.chunk.js";import{O as j,s as z,m as H,f as V,d as F,t as U,E as K,c as X,B as q,S as G}from"./vendor-rxjs.Dumdyjy0.chunk.js";import{i as Q,g as Y,a as Z,b as ee,s as et,l as en,c as ea,d as ei,e as er}from"./vendor-innoai-tech-lodash.CLOxyLis.chunk.js";import{M as el}from"./lib-nodepkg-vuemarkdown.ZmVa-sa_.chunk.js";class eo extends j{constructor(e,t){super(e=>{let t=this.#e.subscribe(e);return()=>{t.unsubscribe()}}),this.typedef=e,this.initials=t,this.#e.next(t)}static of(e,t){return new eo(e,t??("array"==e.type?[]:{}))}#e=new r({});isDirty(e,t){if(!Q(e)){let n=Y(this.initials,t);return Z(n)||n!==e}return!1}update(e,t,n){if(this.#t.next({}),0==e.length)return void this.#e.next(t);ee(t)?this.#e.next(a=>{let i=Y(a,e,n);t(i),et(a,e,i)}):this.#e.next(n=>{et(n,e,t)})}delete(e){0!=e.length&&this.#e.next(t=>{let n=en(e);if(ea(n)){let a=e.slice(0,e.length-1),i=a.length>0?Y(t,a):t;if(ei(i))return void i.splice(n,1)}let a=e.slice(0,e.length-1),i=a.length>0?Y(t,a):t;delete i[n]})}#t=new r({});get error$(){return this.#t}setError(e,t){let n=b.create(e);this.#t.next(e=>{null===t?delete e[n]:e[n]=t})}}let es=i(()=>new eo(g(),{})),ed=i(()=>({})),ep=E("span",{displayName:"ActionToolbar"})({px:2,pos:"relative",display:"flex",alignItems:"center",gap:8,visibility:"hidden"}),ec=E("span",({},{slots:e})=>t=>l(t,{children:l(ep,{"data-visible-on-hover":!0,children:e.default?.()})}),{displayName:"Actions"})({display:"flex"}),eu=E(P,{displayName:"ActionBtn"})({transition:"none",width:24,height:24,rounded:12,[`& ${J}`]:{svg:{width:18,height:18}}});class eh extends r{static from(e){let t=new eh(!1);return s(e,z(e=>e?H(s(V(e,"focus"),U(()=>{t.show()})),s(V(e,"blur"),F(200),U(()=>{t.value&&t.hide()}))):K),d()),t}show(){this.next(!0)}hide(){this.next(!1)}}let ey=I({apply({elements:e,rects:t}){Object.assign(e.floating.style,{width:`${t.reference.width}px`})}}),em=o((e,{emit:t,slots:n,render:a})=>{let i=e.open$??new eh(!1),r=e=>{let n=[e.target,...e.composedPath()].find(e=>e?.hasAttribute?.("data-value"));if(n){let e=n.getAttribute("data-value");Z(e)||(t("selected",e),i.hide())}};return s(i,a(e=>l(T,{isOpen:e,onClickOutside:()=>i.hide(),onEscKeydown:()=>i.hide(),placement:"bottom-start",middleware:[ey],$content:l(ef,{onClick:r,children:n.content?.()}),children:n.default?.()?.[0]??null})))},{displayName:"Menu",props:["open$"],emits:["selected"]});o((e,{slots:t,render:n})=>{let a=e.open$??new eh(!1);return s(a,n(e=>l(T,{isOpen:e,onClickOutside:()=>a.hide(),placement:"bottom-start",$content:l(ef,{children:t.content?.()}),children:t.default?.()?.[0]??null})))},{displayName:"Popover",props:["open$"]});let ef=E("div",{displayName:"PopoverContainer"})({textStyle:"sys.body-small",pos:"relative",roundedBottom:"sm",containerStyle:"sys.surface-container-lowest",borderBottom:"1px solid",borderRight:"1px solid",borderLeft:"1px solid",borderColor:A("sys.outline-variant",D(.38))}),ex=E("div",{displayName:"MenuItem"})({px:8,py:2,gap:8,display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"right",textStyle:"sys.body-small",cursor:"pointer",_hover:{containerStyle:"sys.surface-container"},_focus:{containerStyle:"sys.surface-container",outline:0}}),ev=o((e,{slots:t,render:n})=>{let a=new eh(!1);return s(a,n(n=>{let i=t.default?.()[0];return l(T,{isOpen:n,placement:e.placement??"left",$content:l(eg,{children:l(eb,{children:t.title()})}),children:i?p(i,{onMouseover:()=>{a.show()},onMouseout:()=>{a.hide()}}):null})}))},{displayName:"Tooltip",props:["placement"]}),eb=E("div",{displayName:"TooltipContainer"})({py:4,px:12,rounded:"xs",shadow:"3",textStyle:"sys.body-small",containerStyle:"sys.on-surface",pos:"relative",zIndex:100}),eg=E("div",{displayName:"TooltipWrapper"})({px:8}),ew=E("span",{displayName:"Token"})({textStyle:"sys.label-small",fontWeight:"bold",fontFamily:"inherit",fontSize:12,lineHeight:24,wordBreak:"keep-all",whiteSpace:"nowrap",font:"code",opacity:.3}),eN=o((e,{slots:t})=>()=>c(ek,{"data-deprecated":e.deprecated,"data-optional":e.optional,"data-nullable":e.nullable,children:[t.leading&&l(eC,{"data-visible-on-hover":!0,children:t.leading()}),t.default?.()]}),{displayName:"PropName",props:["deprecated","optional","nullable"]}),eC=E(ep,{displayName:"PropLeading"})({position:"absolute",ml:-28}),ek=E("div",{displayName:"PropNameView"})({position:"relative",display:"flex",alignItems:"center",textStyle:"sys.label-small",fontWeight:"bold",fontFamily:"inherit",wordBreak:"keep-all",whiteSpace:"nowrap",border:"1px solid",borderColor:"rgba(0,0,0,0)",fontSize:12,lineHeight:24,_deprecated:{textDecoration:"line-through"},_optional:{"&:after":{content:'"?"',color:"sys.secondary",opacity:.58}}}),eS=E("div",{displayName:"LineTitle"})({position:"absolute",zIndex:1,left:0,opacity:.58,fontSize:10,lineHeight:10,top:0,"& > *":{display:"flex",alignItems:"center",gap:4,"&::before":{content:'"// "',font:"code"}}}),e$=E("div",{displayName:"LineError"})({display:"block",fontSize:10,lineHeight:14,color:"sys.error"}),eO=E("div",{displayName:"LineContainer"})({position:"relative",py:4,_hover:{containerStyle:"sys.surface-container","& [data-visible-on-hover]":{visibility:"visible"}},"&:focus-within":{containerStyle:"sys.surface-container"},_dirty:{bgColor:A("sys.warning-container",D(.38))},_error:{bgColor:"sys.error-container"},[`&:has(${ec})`]:{[`& > ${e$}`]:{display:"none"},_error:{bgColor:"inherit"}}}),eE=i(()=>({indent:0,$container:u(null)}),{name:"IntentContext"}),eI=h((e,{slots:t})=>{let n=eE.use(),a=u(null),i=u(null);return()=>c(m,{children:[l(ew,{children:e.openToken}),t.leading?.(),c(y,{to:n.$container.value,children:[c(eD,{"data-indent":n.indent,children:[l(eA,{ref:a}),l(eR,{ref:i}),i.value&&l(eE,{value:{$container:i,indent:1+(n.indent??0)},children:t.trailing?.()})]}),l(eP,{style:{paddingLeft:`${32*n.indent}px`,display:"flex"},children:l(ew,{children:e.closeToken})})]}),a.value&&l(eE,{value:{$container:a,indent:1+(n.indent??0)},children:t.default?.()})]})},{displayName:"Block",props:["openToken","closeToken"]}),eT=o((e,{slots:t,render:n})=>{let a=eE.use(),i=s(es.use().error$,n(n=>{let i=b.create(e.path),r=!e.viewOnly&&!!n[i];return c(eO,{"data-error":r,"data-dirty":e.dirty,style:{paddingLeft:`${32*a.indent}px`},children:[(e.title||e.description)&&l(eS,{style:{paddingLeft:`${32*a.indent}px`},children:e.description?l(ev,{$title:l(eJ,{children:l(el,{text:e.description})}),children:c("div",{children:[e.title," ",l(J,{path:L})]})}):l("span",{children:e.title})}),l(eP,{children:t.default?.()}),r&&l(e$,{children:`${n[i]}`})]})}));return()=>l(y,{to:a.$container.value,children:i})},{displayName:"Line",props:["path","dirty","viewOnly","title","description"]}),eA=E("div",{displayName:"Lines"})({}),eD=E("section",{displayName:"LineSection"})({}),eR=E("div",{displayName:"LinesTrailing"})({}),eP=E("div",{displayName:"LineRow"})({display:"flex",alignItems:"start",pr:10}),eJ=E("span",{displayName:"Description"})({display:"block",textStyle:"sys.body-small","& p":{my:1,wordBreak:"keep-all",whiteSpace:"nowrap",opacity:.7},"& code":{wordBreak:"keep-all",whiteSpace:"nowrap"}}),eL=E("form",{displayName:"FormControls"})({display:"flex",pos:"absolute",right:0,bottom:0,px:8});E("div",{displayName:"FormContainer"})({display:"flex",flexDirection:"column",pos:"relative",textarea:{minW:400,outline:"none",border:"none",bg:"none",py:8,px:12}}),E("div",{displayName:"FormContainerAsRow"})({display:"flex",alignItems:"center",gap:8,pos:"relative",px:8,input:{outline:"none",border:"none",bg:"none",minWidth:"10vw",py:8,px:12},[`& ${eL}`]:{pos:"relative",px:0}});let eM=w(function(){if(a)return n;a=1;var i=t?e:(t=1,e=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach(function(t){e.addRange(t)}),t&&t.focus()}}),r={"text/plain":"Text","text/html":"Url",default:"Text"};return n=function(e,t){var n,a,l,o,s,d,p,c,u=!1;t||(t={}),l=t.debug||!1;try{if(s=i(),d=document.createRange(),p=document.getSelection(),(c=document.createElement("span")).textContent=e,c.ariaHidden="true",c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),void 0===n.clipboardData){l&&console.warn("unable to use e.clipboardData"),l&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var a=r[t.format]||r.default;window.clipboardData.setData(a,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))}),document.body.appendChild(c),d.selectNodeContents(c),p.addRange(d),!document.execCommand("copy"))throw Error("copy command was unsuccessful");u=!0}catch(i){l&&console.error("unable to copy using execCommand: ",i),l&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(i){l&&console.error("unable to copy using clipboardData: ",i),l&&console.error("falling back to prompt"),n="message"in t?t.message:"Copy to clipboard: #{key}, Enter",a=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C",o=n.replace(/#{\s*key\s*}/g,a),window.prompt(o,e)}}finally{p&&("function"==typeof p.removeRange?p.removeRange(d):p.removeAllRanges()),c&&document.body.removeChild(c),s()}return u}}()),eB=o((e,{})=>()=>l(ev,{$title:"复制当前节点为 JSON 字符串",children:l(eu,{type:"button",onClick:()=>eM(JSON.stringify(e.value,null,2)),children:l(J,{path:M})})}),{displayName:"CopyAsJSONIconBtn",props:["value"]});class e_ extends q{static from(e){let t=new e_("");return s(e,z(e=>e?s(V(e,"input"),U(e=>{t.next(e.target.value.trim())})):K),d()),t}}class eW extends G{static from(e){let t=new eW;return s(e,z(e=>e?H(s(V(e,"keypress"),U(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t.next({type:"COMMIT"}))})),s(V(e,"keydown"),U(e=>{switch(e.key){case"Tab":case"ArrowDown":e.target.getAttribute("data-options")&&(e.preventDefault(),t.next({type:"SELECT",direction:1}));break;case"ArrowUp":e.target.getAttribute("data-options")&&(e.preventDefault(),t.next({type:"SELECT",direction:-1}))}})),s(V(e,"keyup"),U(e=>{"Escape"===e.key&&t.next({type:"CANCEL"})}))):K),d()),t}}class ej extends j{static sync(e,t){return s(H(s(e,U(e=>{e&&e==b.create(t.path())&&t.editing$.show()})),s(t.editing$,F(1),U(n=>{n||e.disable(t.path())})),s(X([t.value$,e]),F(1),U(([n,a])=>{Z(n)&&!a&&e.enable(t.path())}))),d())}#n=new q(null);constructor(){super(e=>{let t=this.#n.subscribe(e);return()=>t.unsubscribe()})}enable(e){this.#n.value||this.#n.next(b.create(e))}disable(e){this.#n.value===b.create(e)&&this.#n.next(null)}}let ez=i(()=>new ej),eH=o((e,{render:t})=>{let n,a=f(null),i=f(null),o=f(null),p=eW.from(o),u=e_.from(o),h=ez.use(),y=eh.from(o),m=es.use();ej.sync(h,{editing$:y,value$:e.value$,path:()=>e.ctx.path});let v=()=>{if("enums"===e.typedef.type){let t=(N.schemaProp(e.typedef,"enum")??[]).indexOf(e.value);if(t>-1)return t}return 0},b=new r({index:v()}),g=()=>{u.next(""),y.hide()},w=t=>{if("enums"===e.typedef.type){let n=N.schemaProp(e.typedef,"enum")??[];t??=n[b.value.index%n.length]}else t??=o.value?.value?o.value?.value:void 0;if(Z(t))return void m.delete(e.ctx.path);let[n,a]=e.typedef.validate(t,{coerce:!0});if(n)return void m.setError(e.ctx.path,n.message);m.update(e.ctx.path,a),g()};return(e.allowRawJSON&&s(u,U(t=>{let n=t.trim();if(n.startsWith("{")&&n.endsWith("}")||n.startsWith("[")&&n.endsWith("]"))try{let t=JSON.parse(n);m.update(e.ctx.path,t),g()}catch(t){m.setError(e.ctx.path,"无效的 JSON 字符串")}}),d()),s(p,U(t=>{switch(t.type){case"SELECT":b.next(e=>{e.index+=t.direction});break;case"COMMIT":w();break;case"CANCEL":g(),b.next({index:v()}),Z(e.value)&&m.delete(e.ctx.path)}}),d()),s(H(s(i,x(e=>{if(e){let t=new ResizeObserver(e=>{for(let t of e)t.contentBoxSize&&(n=t.contentBoxSize[0]?.blockSize)});return t.observe(e),()=>{t.disconnect()}}return()=>{}})),s(o,F(1),U(e=>{e&&(e?.focus(),e.value&&(e.selectionStart=0,e.selectionEnd=e.value.length))})),s(o,z(e=>{if(e){let t=n?n-2:e.getBoundingClientRect().height,r=e=>{e.style.height=`${t??0}px`,e.style.height=`${e.scrollHeight}px`};return setTimeout(()=>r(e)),H(s(V(e,"blur"),U(t=>{t.relatedTarget&&(i.value?.contains(t.relatedTarget)||a.value?.contains(t.relatedTarget))||(t.preventDefault(),w(e.value))})),s(V(e,"input"),U(e=>{r(e.target),u.next(e.target.value)})))}return K}))),d()),"enums"==e.typedef.type)?s(X([e.value$,y,b]),t(([t,n,{index:r}])=>{let s=N.schemaProp(e.typedef,"enum")??[],d=N.metaProp(e.typedef,"enumLabels")??[];return l(eK,{ref:i,onClick:()=>{y.show()},"data-type":typeof t,tabindex:0,children:n?l(em,{onSelected:e=>{w(e)},open$:y,$content:l("div",{ref:a,children:s.map((e,t)=>l(eq,{"data-focus":r%s.length===t,value:e,label:d[t]}))}),children:l(eF,{children:l("input",{value:void 0==t?"":`${t}`,ref:o,"data-options":!0})})}):l(eU,{children:JSON.stringify(t)??"undefined"})})})):s(X([e.value$,y]),t(([e,t])=>l(eK,{ref:i,onClick:()=>{y.show()},"data-type":typeof e,tabindex:0,onFocus:()=>{y.show()},children:t?l(T,{isOpen:!0,placement:"right-start",$content:c(eV,{ref:a,children:[l(eu,{type:"button",onClick:()=>p.next({type:"CANCEL"}),children:l(J,{path:B})}),l(eu,{type:"button",onClick:()=>p.next({type:"COMMIT"}),children:l(J,{path:_})})]}),children:l(eF,{children:l("textarea",{ref:o,rows:1,value:void 0==e?"":`${e}`})})}):l(eU,{children:JSON.stringify(e)??"undefined"})})))},{displayName:"ValueInput",props:["typedef","ctx","value","allowRawJSON"]}),eV=E("div",{displayName:"ValueInputActions"})({borderRight:"1px solid",borderTop:"1px solid",borderBottom:"1px solid",borderColor:A("sys.outline-variant",D(.38)),containerStyle:"sys.surface-container-lowest",roundedRight:"sm",display:"flex",px:2,py:0,ml:-4}),eF=E("div",{displayName:"InputWrapper"})({width:"100%",maxWidth:"40vw",display:"flex",alignItems:"center",border:"1px solid",overflow:"hidden",borderColor:A("sys.outline-variant",D(.38)),opacity:.38,"&:hover":{opacity:1},"&:focus-within":{opacity:1},"& > textarea,input":{flex:1,rounded:"xs",containerStyle:"sys.surface-container-lowest",width:"100%",outline:"none",border:"none",px:8,py:0,m:0,fontSize:"inherit",color:"inherit",lineHeight:"inherit",overflow:"hidden",resize:"none","&[data-options]:focus":{roundedBottom:0}}}),eU=E("div",{displayName:"Value"})({border:"1px solid",borderColor:"rgba(0,0,0,0)",maxWidth:"40vw",width:"100%",overflow:"hidden",textOverflow:"ellipsis",_hover:{textOverflow:"clip",whiteSpace:"normal",wordBreak:"break-all"}}),eK=E("div",{displayName:"ValueContainer"})({wordBreak:"keep-all",whiteSpace:"nowrap",cursor:"pointer",display:"flex",alignItems:"center",font:"code",width:"100%",textStyle:"sys.label-small",fontSize:12,lineHeight:24,gap:8,_type__string:{color:"sys.primary"},_type__number:{color:"sys.primary"},_type__boolean:{color:"sys.warning"},_type__undefined:{color:"sys.error"}}),eX=E(ex,{displayName:"EnumMenuItemContainer"})({[`& ${eN}`]:{textAlign:"left"}}),eq=h(e=>()=>c(eX,{"data-value":e.value,tabindex:0,children:[l(eN,{children:e.value}),e.label&&l(eJ,{children:e.label})]}),{displayName:"EnumMenuItem",props:["value","label"]}),eG=o(({},{emit:e})=>()=>l(ev,{$title:"删除属性",children:l(eu,{type:"button",onClick:()=>e("remove"),children:l(J,{path:W})})}),{displayName:"RemovePropIconBtn",emits:["remove"]}),eQ=o((e,{render:t})=>{let n=es.use(),a=ed.use();return s(e.value$,t(t=>l(eI,{openToken:"{",closeToken:"}",$leading:l(ec,{children:l(eB,{value:t})}),$trailing:l(eY,{ctx:e.ctx,onAdd:t=>{n.update([...e.ctx.path,t],void 0)},options:[...e.typedef.entries(t,e.ctx)].filter(([e])=>!Object.hasOwn(t,e)).map(([e,t,n])=>({propName:String(e),typedef:n}))},"prop-input"),children:[...e.typedef.entries(t,e.ctx)].map(([i,r,o])=>{if(!Object.hasOwn(t,i))return null;let s=[...e.ctx.path,i];return c(eT,{path:s,dirty:n.isDirty(r,s),title:N.metaProp(o,"title"),description:N.metaProp(o,"description"),children:[l(eN,{deprecated:N.schemaProp(o,"deprecated"),$leading:l(eG,{onRemove:()=>{n.delete(s)}}),children:String(i)}),c(ew,{children:[":","\xa0"]}),a.$value?.(o,r,{...e.ctx,path:s,branch:[...e.ctx.branch,r]})]})})})))},{displayName:"ObjectInput",props:["typedef","ctx","value"]}),eY=o((e,{emit:t,render:n})=>{let a=f(null),i=eW.from(a),o=e_.from(a),p=eh.from(a),u=es.use(),h=new r({index:0}),y=()=>{p.hide(),o.next(""),a.value&&(a.value.value="",a.value.blur()),h.next({index:0})};s(o,U(t=>{let n=t.trim();if(n.startsWith("{")&&n.endsWith("}"))try{let t=JSON.parse(n);u.update(e.ctx.path,t),y()}catch(t){u.setError(e.ctx.path,"无效的 JSON 字符串")}}),d());let m=n=>{e.options?n??=e.options[h.value.index%e.options.length]?.propName:n??=o.value,n?(t("add",n),y()):u.setError([...e.ctx.path,N.RecordKey],"无效的属性值")};s(i,U(e=>{switch(e.type){case"SELECT":h.next(t=>{t.index+=e.direction});break;case"COMMIT":m();break;case"CANCEL":y()}}),d());let x=s(p,n(e=>l(eF,{children:l("input",{ref:a,type:"text",placeholder:"添加属性 (可粘贴 JSON 字符串)","data-options":e})})));return s(X([o,p,h,e.options$]),n(([t,n,r,o])=>o?o.length>0?l(eT,{path:e.ctx.path,children:l(eK,{sx:{mx:-4},children:l(em,{onSelected:e=>{m(e)},open$:p,$content:l("div",{children:o.map((e,n)=>t&&!e.propName.includes(t)?null:l(eZ,{propName:e.propName,typedef:e.typedef,"data-focus":n===r.index%o.length}))}),children:x})})}):null:l(eT,{path:[...e.ctx.path,N.RecordKey],children:l(eK,{sx:{mx:-4},children:l(T,{isOpen:n,placement:"right-start",$content:c(eV,{children:[l(eu,{type:"button",onClick:()=>i.next({type:"CANCEL"}),children:l(J,{path:B})}),l(eu,{type:"button",onClick:()=>i.next({type:"COMMIT"}),children:l(J,{path:_})})]}),children:l(eF,{children:l("input",{ref:a,type:"text",placeholder:"添加属性 (可粘贴 JSON 字符串)"})})})})})))},{displayName:"PropValueInput",props:["ctx","options"],emits:["add"]}),eZ=h(e=>()=>c(e0,{"data-value":e.propName,tabindex:0,children:[l(eN,{optional:N.schemaProp(e.typedef,N.optional),children:e.propName}),l(eJ,{children:N.metaProp(e.typedef,"title")})]}),{displayName:"PropMenuItem",props:["propName","typedef"]}),e0=E(ex,{displayName:"AddPropMenuItemContainer"})({[`& ${eN}`]:{textAlign:"left"}}),e1=o((e,{render:t})=>{let n=es.use(),a=ed.use();return s(e.value$,t(t=>l(eI,{openToken:"[",closeToken:"]",$leading:l(ec,{children:l(eB,{value:t})}),$trailing:l(e2,{ctx:e.ctx,typedef:e.typedef,onAdd:t=>{n.update(e.ctx.path,e=>{e.push(t)},[])}}),children:[...e.typedef.entries(t,e.ctx)].map(([t,i,r])=>{let o=[...e.ctx.path,t];return c(eT,{path:o,dirty:n.isDirty(i,o),children:[l(eN,{$leading:l(e8,{onRemove:()=>{n.delete(o)}}),children:l(R,{sx:{opacity:.3,mr:"0.5em"},children:String(t)})}),a.$value?.(r,i,{...e.ctx,path:o,branch:[...e.ctx.branch,i]})]})})})))},{displayName:"ArrayInput",props:["ctx","value","typedef"]}),e2=o((e,{emit:t,render:n})=>{let a=f(null),i=e_.from(a),r=eW.from(a),o=eh.from(a),p=es.use(),u=()=>{a.value&&(a.value.value="",a.value.blur())},h=n=>{if(n??=i.value){let[a,i]=N.schemaProp(e.typedef,"items").validate(n,{coerce:!0});if(a)return void p.setError(e.ctx.path,a);t("add",i)}else t("add",void 0);u()};s(i,U(t=>{let n=t.trim();if(n.startsWith("[")&&n.endsWith("]"))try{let t=JSON.parse(n);p.update(e.ctx.path,t),u()}catch(t){p.setError(e.ctx.path,"无效的 JSON 字符串")}if(n.startsWith("{")&&n.endsWith("}"))try{h(JSON.parse(n))}catch(t){p.setError(e.ctx.path,"无效的 JSON 字符串")}}),d()),s(r,U(e=>{switch(e.type){case"COMMIT":h();break;case"CANCEL":u()}}),d());let y=s(o,n(e=>l(T,{isOpen:e,placement:"right-start",$content:c(eV,{children:[l(eu,{type:"button",onClick:()=>r.next({type:"CANCEL"}),children:l(J,{path:B})}),l(eu,{type:"button",onClick:()=>r.next({type:"COMMIT"}),children:l(J,{path:_})})]}),children:l(eF,{children:l("input",{ref:a,type:"text",placeholder:"添加数组项 (可粘贴 JSON 字符串)"})})})));return()=>l(eT,{path:e.ctx.path,children:l(eK,{sx:{mx:-4},children:y})})},{displayName:"AddItemIconBtn",props:["ctx","typedef"],emits:["add"]}),e8=o(({},{emit:e})=>()=>l(ev,{$title:"移除项",children:l(eu,{type:"button",onClick:()=>e("remove"),children:l(J,{path:W})})}),{displayName:"RemoteItemIconBtn",emits:["remove"]}),e4=o((e,{render:t})=>{let n=es.use(),a=ed.use();return s(e.value$,t(t=>l(eI,{openToken:"{",closeToken:"}",$leading:l(ec,{children:l(eB,{value:t})}),$trailing:l(eY,{ctx:e.ctx,onAdd:t=>{n.update([...e.ctx.path,t],void 0)}},"prop-input"),children:[...e.typedef.entries((()=>{let e={};for(let n of Object.keys(t??{}).toSorted())e[n]=t?.[n];return e})(),e.ctx)].map(([i,r,o])=>{if(!Object.hasOwn(t,i))return null;let s=[...e.ctx.path,i];return c(eT,{path:s,dirty:n.isDirty(r,s),children:[l(eN,{$leading:l(eG,{onRemove:()=>{n.delete(s)}}),children:String(i)}),c(ew,{children:[":","\xa0"]}),a.$value?.(o,r,{...e.ctx,path:s,branch:[...e.ctx.branch,r]})]})})})))},{displayName:"RecordInput",props:["ctx","value","typedef"]}),e3=o((e,{render:t})=>s(e.value$,t(t=>ei(t)?l(e1,{value:t,typedef:C(k()),ctx:e.ctx}):er(t)?l(e4,{value:t,typedef:S($(),k()),ctx:e.ctx}):l(eH,{value:t,typedef:k(),ctx:e.ctx,allowRawJSON:!0}))),{displayName:"AnyInput",props:["typedef","ctx","value"]}),e5=(e,t,n)=>{if("object"==e.type||"intersection"==e.type||"union"==e.type&&N.schemaProp(e,"discriminator"))return l(eQ,{typedef:e,value:t??{},ctx:n});if("union"==e.type&&Z(N.schemaProp(e,"discriminator"))){let a=N.schemaProp(e,"oneOf");if(a?.length==2){let e=a.find(e=>"array"==e.type),i=a.find(e=>"array"!=e.type);if(e&&i&&N.schemaProp(e,"items").type==i.type)return l(e1,{typedef:e,value:ei(t)?t:Z(t)?[]:[t],ctx:n})}return l(eH,{typedef:e,value:t,ctx:n,allowRawJSON:!0})}return"record"==e.type?l(e4,{typedef:e,value:t,ctx:n}):"array"==e.type?l(e1,{typedef:e,value:t,ctx:n}):"any"==e.type||"unknown"==e.type?l(e3,{typedef:e,value:t,ctx:n}):l(eH,{typedef:e,value:t,ctx:n})},e7=o(({},{render:e})=>{let t=es.use(),n=ed.use(),a=v(null);return s(t,e(e=>{let i=n.$value??e5;return l(ez,{children:l(ed,{value:{$value:n.$value??e5},children:c(e6,{children:[l("section",{ref:a}),a.value&&l(eE,{value:{indent:0,$container:a},children:l(eT,{path:[],viewOnly:!0,children:i(t.typedef,e,O)})})]})})})}))},{displayName:"JSONEditorView"}),e6=E("div",{displayName:"JSONEditorContainer"})({width:"100%",height:"100%",overflow:"auto",section:{display:"flex",flexDirection:"column",minWidth:"max-content"}});export{eo as J,es as a,e7 as b,eM as c};
