class A extends TypeError{constructor(n,r){let t;const{message:i,explanation:o,...f}=n,{path:c}=n,u=c.length===0?i:`At path: ${c.join(".")} -- ${i}`;super(o??u),o!=null&&(this.cause=u),Object.assign(this,f),this.name=this.constructor.name,this.failures=()=>t??(t=[n,...r()])}}function E(e){return g(e)&&typeof e[Symbol.iterator]=="function"}function g(e){return typeof e=="object"&&e!=null}function b(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;const n=Object.getPrototypeOf(e);return n===null||n===Object.prototype}function y(e){return typeof e=="symbol"?e.toString():typeof e=="string"?JSON.stringify(e):`${e}`}function k(e){const{done:n,value:r}=e.next();return n?void 0:r}function F(e,n,r,t){if(e===!0)return;e===!1?e={}:typeof e=="string"&&(e={message:e});const{path:i,branch:o}=n,{type:f}=r,{refinement:c,message:u=`Expected a value of type \`${f}\`${c?` with refinement \`${c}\``:""}, but received: \`${y(t)}\``}=e;return{value:t,type:f,refinement:c,key:i[i.length-1],path:i,branch:o,...e,message:u}}function*w(e,n,r,t){E(e)||(e=[e]);for(const i of e){const o=F(i,n,r,t);o&&(yield o)}}function*$(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{path:t=[],branch:i=[e],coerce:o=!1,mask:f=!1}=r,c={path:t,branch:i};if(o&&(e=n.coercer(e,c),f&&n.type!=="type"&&g(n.schema)&&g(e)&&!Array.isArray(e)))for(const s in e)n.schema[s]===void 0&&delete e[s];let u="valid";for(const s of n.validator(e,c))s.explanation=r.message,u="not_valid",yield[s,void 0];for(let[s,d,O]of n.entries(e,c)){const S=$(d,O,{path:s===void 0?t:[...t,s],branch:s===void 0?i:[...i,d],coerce:o,mask:f,message:r.message});for(const m of S)m[0]?(u=m[0].refinement!=null?"not_refined":"not_valid",yield[m[0],void 0]):o&&(d=m[1],s===void 0?e=d:e instanceof Map?e.set(s,d):e instanceof Set?e.add(d):g(e)&&(d!==void 0||s in e)&&(e[s]=d))}if(u!=="not_valid")for(const s of n.refiner(e,c))s.explanation=r.message,u="not_refined",yield[s,void 0];u==="valid"&&(yield[void 0,e])}class l{assert(n,r){return I(n,this,r)}create(n,r){return P(n,this,r)}is(n){return j(n,this)}mask(n,r){return J(n,this,r)}validate(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return p(n,this,r)}constructor(n){const{type:r,schema:t,validator:i,refiner:o,coercer:f=u=>u,entries:c=function*(){}}=n;this.type=r,this.schema=t,this.entries=c,this.coercer=f,i?this.validator=(u,s)=>w(i(u,s),s,this,u):this.validator=()=>[],o?this.refiner=(u,s)=>w(o(u,s),s,this,u):this.refiner=()=>[]}}function I(e,n,r){const t=p(e,n,{message:r});if(t[0])throw t[0]}function P(e,n,r){const t=p(e,n,{coerce:!0,message:r});if(t[0])throw t[0];return t[1]}function J(e,n,r){const t=p(e,n,{coerce:!0,mask:!0,message:r});if(t[0])throw t[0];return t[1]}function j(e,n){return!p(e,n)[0]}function p(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const t=$(e,n,r),i=k(t);return i[0]?[new A(i[0],function*(){for(const f of t)f[0]&&(yield f[0])}),void 0]:[void 0,i[1]]}function h(e,n){return new l({type:e,schema:null,validator:n})}function M(){return h("any",()=>!0)}function N(){return h("boolean",e=>typeof e=="boolean")}function q(e){const n={},r=e.map(t=>y(t)).join();for(const t of e)n[t]=t;return new l({type:"enums",schema:n,validator(t){return e.includes(t)||`Expected one of \`${r}\`, but received: ${y(t)}`}})}function z(e){return new l({...e,validator:(n,r)=>n===void 0||e.validator(n,r),refiner:(n,r)=>n===void 0||e.refiner(n,r)})}function B(){return h("string",e=>typeof e=="string"||`Expected a string, but received: ${y(e)}`)}function C(){return h("unknown",()=>!0)}function D(e,n,r){return new l({...e,coercer:(t,i)=>j(t,n)?e.coercer(r(t,i),i):e.coercer(t,i)})}function G(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return D(e,C(),t=>{const i=typeof n=="function"?n():n;if(t===void 0)return i;if(!r.strict&&b(t)&&b(i)){const o={...t};let f=!1;for(const c in i)o[c]===void 0&&(o[c]=i[c],f=!0);if(f)return o}return t})}function H(e,n,r){return new l({...e,*refiner(t,i){yield*e.refiner(t,i);const f=w(r(t,i),i,e,t);for(const c of f)yield{...c,refinement:n}}})}class a extends l{static define(n,r){return a.wrap(h(n,r))}static refine(n,r,t){return a.wrap(H(n,r,t))}static wrap(n){for(var r=arguments.length,t=new Array(r>1?r-1:0),i=1;i<r;i++)t[i-1]=arguments[i];let o=new a(n);for(const f of t)o=f(o);return o}optional(){return a.wrap(z(this))}default(n){return a.wrap(G(this,n))}use(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return r.reduce((i,o)=>o(i),this)}constructor({meta:n,...r}){super(r),this.meta=n??{}}}const K=()=>a.wrap(M()),L=()=>a.wrap(B()),Q=()=>a.wrap(N());function R(e){return a.wrap(q(e))}function U(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"custom";return a.define(n,e??(()=>!0))}export{K as a,Q as b,U as c,R as e,L as s};
