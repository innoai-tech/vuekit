import{c as e,I as t,r as r,a as n,j as a,b as i,s as l,d as o,o as s,e as d,t as p,f as c,F as u}from"./lib-nodepkg-vuekit.D92ITxuR.chunk.js";import{S as h,a as y,b as f,r as m,s as x,J as v,o as b,g as g,E as w}from"./lib-nodepkg-typedef.BPUBEIvg.chunk.js";import{g as N,i as C,a as E,b as $,c as S,s as k,l as O,d as P,e as I,f as A}from"./vendor-innoai-tech-lodash.D_xiL3Ol.chunk.js";import{O as D,d as T,m as L,s as J,a as M,f as R,b as W,t as j,E as B,c as _,B as z,S as F}from"./vendor-rxjs.02BiId9e.chunk.js";import{s as V,a as U,P as X,v as H,b as K,B as q}from"./lib-nodepkg-vueuikit.CtwADLw5.chunk.js";import{I as G,a as Q}from"./lib-nodepkg-vuematerial.g9ZKlwwK.chunk.js";import{m as Y,a as Z,b as ee,c as et,d as er,e as en,f as ea}from"./webapp-vuekit-layout.Ci5pIZnr.chunk.js";import{M as ei}from"./lib-nodepkg-vuemarkdown.c6SnZOAp.chunk.js";let el=e=>E(e)?e:C(e)?[]:[e];var eo,es,ed,ep,ec,eu,eh=((es=eh||{})[es.NONE=0]="NONE",es[es.EXACT=1]="EXACT",es[es.PREFIX=2]="PREFIX",es),ey=((eo=ey||{}).NONE="NONE",eo.ADD="ADD",eo.EDIT="EDIT",eo.DELETE="DELETE",eo);class ef extends D{constructor(e,t){super(e=>{let t=this.#e.subscribe(e);return()=>{t.unsubscribe()}}),this.typedef=e,this.initials=t,this.#e.next(t)}static of(e,t){return new ef(e,t??("array"==e.type?[]:{}))}#e=new t({});initialsAt(e){return 0==e.length?this.initials:N(this.initials,e)}update(e,t,r,n){if(console.log("[json-editor]","update",JSON.stringify(e),this.typedef.type),this.#t.next({}),0==e.length)return void this.#e.next(t);S(t)?this.#e.next(a=>{let i=N(a,e,r);n&&"array"==n.type&&!E(i)&&(i=el(i)),t(i),k(a,e,i)}):this.#e.next(r=>{k(r,e,t)})}delete(e){0!=e.length&&(console.log("[json-editor]","delete",e),this.#e.next(t=>{let r=O(e);if(P(r)){let n=e.slice(0,e.length-1),a=n.length>0?N(t,n):t;if(E(a))return void a.splice(r,1)}let n=e.slice(0,e.length-1),a=n.length>0?N(t,n):t;delete a[r]}))}#t=new t({});#r=new t({});get error$(){return this.#t}get foldedPointerPrefixes$(){return this.#r}errorAt$(e){let t=this.#n(e);return r(this.error$,L(e=>e[t]),T())}foldedPrefix$(e){let t=this.#n(e);return r(this.foldedPointerPrefixes$,L(e=>{for(let[r]of Object.entries(e)){if(r===t)return 1;if(t.startsWith(r))return 2}return 0}),T())}#n(e){return I(e)?e:v.create(e)}toggleFold(e){let t=this.#n(e);this.#r.next(e=>{Object.hasOwn(e,t)?delete e[t]:e[t]=!0})}setError(e,t){let r=this.#n(e);this.#t.next(e=>{null===t?delete e[r]:e[r]=t})}}let em=e(()=>new ef(b(),{})),ex=e(()=>({})),ev=V("span",{displayName:"ActionToolbar"})({px:2,pos:"relative",visibility:"hidden",border:"1px solid",borderColor:"rgba(0,0,0,0)",display:"flex",alignItems:"center"}),eb=V(G,{displayName:"ActionBtn"})({transition:"none",width:24,height:24,rounded:"xs",[`& ${Q}`]:{svg:{width:16,height:16}}}),eg=V("span",{displayName:"TextBox"})({textStyle:"sys.label-small",fontWeight:"bold",fontFamily:"inherit",fontSize:12,border:"1px solid",borderColor:"rgba(0,0,0,0)",py:4,wordBreak:"keep-all",whiteSpace:"nowrap"}),ew=V(eg,{displayName:"TokenView"})({font:"code",opacity:.3}),eN=V(ev,{displayName:"PropLeading"})({position:"absolute",ml:-28}),eC=V(eg,{displayName:"PropNameView"})({position:"relative",display:"flex",alignItems:"center",userSelect:"none",_deprecated:{textDecoration:"line-through"},_optional:{"&:after":{content:'"?"',color:"sys.secondary",opacity:.58}}}),eE=n((e,{slots:t})=>()=>a(eC,{"data-deprecated":e.deprecated,"data-optional":e.optional,"data-nullable":e.nullable,children:[t.leading&&i(eN,{"data-visible-on-hover":!0,children:t.leading()}),t.default?.()]}),{displayName:"PropName",props:["deprecated","optional","nullable"]});class e$ extends t{static from(e){let t=new e$(!1);return r(e,J(e=>e?M(r(R(e,"focus"),j(()=>{t.show()})),r(R(e,"blur"),W(200),j(()=>{t.value&&t.hide()}))):B),l()),t}show(){this.next(!0)}hide(){this.next(!1)}}let eS=U({apply({elements:e,rects:t}){Object.assign(e.floating.style,{width:`${t.reference.width}px`})}}),ek=n((e,{emit:t,slots:n,render:a})=>{let l=e.open$??new e$(!1),o=e=>{let r=[e.target,...e.composedPath()].find(e=>e?.hasAttribute?.("data-value"));if(r){let e=r.getAttribute("data-value");C(e)||(t("selected",e),l.hide())}};return r(l,a(e=>i(X,{isOpen:e,onClickOutside:()=>l.hide(),onEscKeydown:()=>l.hide(),placement:"bottom-start",middleware:[eS],$content:i(eO,{onClick:o,children:n.content?.()}),children:n.default?.()?.[0]??null})))},{displayName:"Menu",props:["open$"],emits:["selected"]});n((e,{slots:t,render:n})=>{let a=e.open$??new e$(!1);return r(a,n(e=>i(X,{isOpen:e,onClickOutside:()=>a.hide(),placement:"bottom-start",$content:i(eO,{children:t.content?.()}),children:t.default?.()?.[0]??null})))},{displayName:"Popover",props:["open$"]});let eO=V("div",{displayName:"PopoverContainer"})({textStyle:"sys.body-small",pos:"relative",containerStyle:"sys.surface-container-lowest",borderBottom:"1px solid",borderRight:"1px solid",borderLeft:"1px solid",borderColor:H("sys.outline-variant",K(.38)),overflow:"hidden","[data-placement*=bottom] &":{roundedBottom:"sm"},"[data-placement*=top] &":{roundedTop:"sm"}}),eP=V("div",{displayName:"MenuItem"})({px:8,py:2,gap:8,display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"right",textStyle:"sys.body-small",cursor:"pointer",_hover:{containerStyle:"sys.surface-container"},_focus:{containerStyle:"sys.surface-container",outline:0}}),eI=V("div",{displayName:"PropDoc"})({position:"absolute",zIndex:1,opacity:.58,fontSize:10,lineHeight:10,top:-3,left:0,"& > *":{display:"flex",alignItems:"center",gap:4,"&::before":{content:'"// "',font:"code"}}}),eA=V("span",{displayName:"PropDescription"})({display:"block",textStyle:"sys.body-small","& p":{my:1,wordBreak:"keep-all",whiteSpace:"nowrap",opacity:.7},"& code":{wordBreak:"keep-all",whiteSpace:"nowrap"}}),eD=n((e,{slots:t,render:n})=>{let a=new e$(!1);return r(a,n(r=>{let n=t.default?.()[0];return i(X,{isOpen:r,placement:e.placement??"left",$content:i(eL,{children:i(eT,{children:t.title()})}),children:n?o(n,{onMouseover:()=>{a.show()},onMouseout:()=>{a.hide()}}):null})}))},{displayName:"Tooltip",props:["placement"]}),eT=V("div",{displayName:"TooltipContainer"})({py:4,px:12,rounded:"xs",shadow:"3",textStyle:"sys.body-small",containerStyle:"sys.on-surface",pos:"relative",zIndex:100}),eL=V("div",{displayName:"TooltipWrapper"})({px:8}),eJ=V("div",{displayName:"LineError"})({display:"block",fontSize:10,lineHeight:14,color:"sys.error",position:"absolute",px:2,top:-2,right:0}),eM=V("div",{displayName:"LinePrefix"})({position:"relative",display:"flex",alignItems:"start",justifyContent:"flex-end",minWidth:"2vw",px:12,userSelect:"none"}),eR=V("div",{displayName:"LineContent"})({flex:1,minW:0}),eW=V("div",{displayName:"LineContentMain"})({position:"relative",display:"flex",alignItems:"start"}),ej=V(ew,{displayName:"LineNumber"})({opacity:.28,font:"code"}),eB=V(ew,e=>t=>i(t,{children:i(Q,{path:e.folded?Y:Z})}),{displayName:"LineFoldable",props:["folded"]})({position:"absolute",top:0,left:2,cursor:"pointer",font:"code",opacity:.58,[`& ${Q}`]:{svg:{width:16,height:16}}}),e_=V("div",(e,{slots:t})=>r=>a(r,{children:[i(eM,{children:t.leading?.()}),i(eR,{sx:{paddingLeft:14*e.indent*2},children:a(eW,{children:[t.default?.(),t.comment?.()]})})]}),{displayName:"LineContainer",props:["indent"]})({position:"relative",display:"flex",py:2,w:"100%",maxW:"100%",_hover:{containerStyle:"sys.surface-container",[`& ${ev}`]:{visibility:"visible"}},"&:focus-within":{containerStyle:"sys.surface-container"},[`&[data-dirty=${ey.EDIT}]`]:{bgColor:H("sys.warning-container",K(.38))},[`&[data-dirty=${ey.ADD}]`]:{bgColor:H("sys.success-container",K(.38))},[`&[data-dirty=${ey.DELETE}]`]:{bgColor:H("sys.error-container",K(.38)),textDecoration:"line-through",opacity:.58},_error:{bgColor:H("sys.error-container",K(.38))}});class ez extends t{static from(e){let t=new ez("");return r(e,J(e=>e?r(R(e,"input"),j(e=>{t.next(e.target.value?.trim())})):B),d()),t}}class eF extends F{static from(e){let t=new eF;return r(e,J(e=>e?M(r(R(e,"keypress"),j(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t.next({type:"COMMIT"}))})),r(R(e,"keydown"),j(e=>{switch(e.key){case"Tab":case"ArrowDown":e.target.getAttribute("data-options")&&(e.preventDefault(),t.next({type:"SELECT",direction:1}));break;case"ArrowUp":e.target.getAttribute("data-options")&&(e.preventDefault(),t.next({type:"SELECT",direction:-1}))}})),r(R(e,"keyup"),j(e=>{"Escape"===e.key&&t.next({type:"CANCEL"})}))):B),d()),t}}class eV extends D{static sync(e,t){return r(M(r(e,j(e=>{e&&e==v.create(t.path())&&t.editing$.show()})),r(t.editing$,W(1),j(r=>{r||e.disable(t.path())})),r(_([t.value$,e]),W(1),j(([r,n])=>{C(r)&&!n&&e.enable(t.path())}))),d())}#a=new z(null);constructor(){super(e=>{let t=this.#a.subscribe(e);return()=>t.unsubscribe()})}enable(e){this.#a.value||this.#a.next(v.create(e))}disable(e){this.#a.value===v.create(e)&&this.#a.next(null)}}let eU=e(()=>new eV),eX=n((e,{render:n})=>{let l,o=s(null),c=s(null),u=s(null),y=eF.from(u),f=ez.from(u),m=eU.use(),x=e$.from(u),v=em.use();eV.sync(m,{editing$:x,value$:e.value$,path:()=>e.ctx.path});let b=()=>{if("enums"===e.typedef.type){let t=(h.schemaProp(e.typedef,"enum")??[]).indexOf(e.value);if(t>-1)return t}return 0},g=new t({index:b()}),w=()=>{f.next(""),x.hide()},N=t=>{if("enums"===e.typedef.type){let r=h.schemaProp(e.typedef,"enum")??[];t??=r[g.value.index%r.length]}else t??=u.value?.value?u.value?.value:void 0;if(C(t))return void v.delete(e.ctx.path);let[r,n]=e.typedef.validate(t,{coerce:!0});if(r)return void v.setError(e.ctx.path,r.message);v.update(e.ctx.path,n),w()};return(e.allowRawJSON&&r(f,j(t=>{let r=t.trim();if(r.startsWith("{")&&r.endsWith("}")||r.startsWith("[")&&r.endsWith("]"))try{let t=JSON.parse(r);v.update(e.ctx.path,t),w()}catch(t){v.setError(e.ctx.path,"无效的 JSON 字符串")}}),d()),r(y,j(t=>{switch(t.type){case"SELECT":g.next(e=>{e.index+=t.direction});break;case"COMMIT":N();break;case"CANCEL":w(),g.next({index:b()}),C(e.value)&&v.delete(e.ctx.path)}}),d()),r(M(r(c,p(e=>{if(e){let t=new ResizeObserver(e=>{for(let t of e)t.contentBoxSize&&(l=t.contentBoxSize[0]?.blockSize)});return t.observe(e),()=>{t.disconnect()}}return()=>{}})),r(u,W(1),j(e=>{e&&(e?.focus(),e.value&&(e.selectionStart=0,e.selectionEnd=e.value.length))})),r(u,J(e=>{if(e){let t=l?l-2:e.getBoundingClientRect().height,n=e=>{e.style.height=`${t??0}px`,e.style.height=`${e.scrollHeight}px`};return setTimeout(()=>n(e)),M(r(R(e,"blur"),j(t=>{t.relatedTarget&&(c.value?.contains(t.relatedTarget)||o.value?.contains(t.relatedTarget))||(t.preventDefault(),N(e.value))})),r(R(e,"input"),j(e=>{n(e.target),f.next(e.target.value)})))}return B}))),d()),"enums"==e.typedef.type)?r(_([e.value$,x,g]),n(([t,r,{index:n}])=>{let a=h.schemaProp(e.typedef,"enum")??[],l=h.metaProp(e.typedef,"enumLabels")??[];return i(eG,{ref:c,onClick:()=>{x.show()},"data-type":typeof t,tabindex:0,children:r?i(ek,{onSelected:e=>{N(e)},open$:x,$content:i("div",{ref:o,children:a.map((e,t)=>i(eY,{"data-focus":n%a.length===t,value:e,label:l[t]}))}),children:i(eK,{children:i("input",{value:void 0==t?"":`${t}`,ref:u,"data-options":!0})})}):i(eq,{children:JSON.stringify(t)??"undefined"})})})):r(_([e.value$,x]),n(([t,r])=>i(eG,{ref:c,onClick:()=>{e.ctx.readOnly||x.show()},onFocus:()=>{e.ctx.readOnly||x.show()},"data-type":typeof t,tabindex:0,children:r?i(X,{isOpen:!0,placement:"right-start",$content:a(eH,{ref:o,children:[i(eb,{type:"button",onClick:()=>y.next({type:"CANCEL"}),children:i(Q,{path:ee})}),i(eb,{type:"button",onClick:()=>y.next({type:"COMMIT"}),children:i(Q,{path:et})})]}),children:i(eK,{children:i("textarea",{ref:u,rows:1,value:void 0==t?"":`${t}`})})}):i(eq,{children:JSON.stringify(t)??"undefined"})})))},{displayName:"ValueInput",props:["typedef","ctx","value","allowRawJSON"]}),eH=V("div",{displayName:"ValueInputActions"})({borderRight:"1px solid",borderTop:"1px solid",borderBottom:"1px solid",borderColor:H("sys.outline-variant",K(.38)),containerStyle:"sys.surface-container-lowest",roundedRight:"sm",display:"flex",px:2,py:0,ml:-4}),eK=V("div",{displayName:"InputWrapper"})({flex:1,minWidth:0,maxWidth:"80%",display:"flex",alignItems:"center",border:"1px solid",overflow:"hidden",borderColor:H("sys.outline-variant",K(.38)),opacity:.38,"&:hover":{opacity:1},"&:focus-within":{opacity:1},"& > textarea,input":{flex:1,rounded:"xs",containerStyle:"sys.surface-container-lowest",width:"100%",outline:"none",border:"none",px:8,py:0,m:0,fontSize:"inherit",color:"inherit",lineHeight:"inherit",overflow:"hidden",resize:"none","&[data-options]:focus":{roundedBottom:0}}}),eq=V("div",{displayName:"Value"})({border:"1px solid",borderColor:"rgba(0,0,0,0)",overflow:"hidden",textOverflow:"ellipsis",_hover:{textOverflow:"clip",whiteSpace:"normal",wordBreak:"break-all"}}),eG=V("div",{displayName:"ValueContainer"})({wordBreak:"keep-all",whiteSpace:"nowrap",cursor:"pointer",display:"flex",alignItems:"center",font:"code",minWidth:0,flex:1,textStyle:"sys.label-small",fontSize:12,lineHeight:24,gap:8,_type__string:{color:"sys.primary"},_type__number:{color:"sys.primary"},_type__boolean:{color:"sys.warning"},_type__undefined:{color:"sys.error"}}),eQ=V(eP,{displayName:"EnumMenuItemContainer"})({[`& ${eE}`]:{textAlign:"left"}}),eY=c(e=>()=>a(eQ,{"data-value":e.value,tabindex:0,children:[i(eE,{children:e.value}),e.label&&i(eA,{children:e.label})]}),{displayName:"EnumMenuItem",props:["value","label"]}),eZ=g(function(){if(eu)return ec;eu=1;var e=ep?ed:(ep=1,ed=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach(function(t){e.addRange(t)}),t&&t.focus()}}),t={"text/plain":"Text","text/html":"Url",default:"Text"};return ec=function(r,n){var a,i,l,o,s,d,p,c,u=!1;n||(n={}),l=n.debug||!1;try{if(s=e(),d=document.createRange(),p=document.getSelection(),(c=document.createElement("span")).textContent=r,c.ariaHidden="true",c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",function(e){if(e.stopPropagation(),n.format)if(e.preventDefault(),void 0===e.clipboardData){l&&console.warn("unable to use e.clipboardData"),l&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var a=t[n.format]||t.default;window.clipboardData.setData(a,r)}else e.clipboardData.clearData(),e.clipboardData.setData(n.format,r);n.onCopy&&(e.preventDefault(),n.onCopy(e.clipboardData))}),document.body.appendChild(c),d.selectNodeContents(c),p.addRange(d),!document.execCommand("copy"))throw Error("copy command was unsuccessful");u=!0}catch(e){l&&console.error("unable to copy using execCommand: ",e),l&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(n.format||"text",r),n.onCopy&&n.onCopy(window.clipboardData),u=!0}catch(e){l&&console.error("unable to copy using clipboardData: ",e),l&&console.error("falling back to prompt"),a="message"in n?n.message:"Copy to clipboard: #{key}, Enter",i=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C",o=a.replace(/#{\s*key\s*}/g,i),window.prompt(o,r)}}finally{p&&("function"==typeof p.removeRange?p.removeRange(d):p.removeAllRanges()),c&&document.body.removeChild(c),s()}return u}}()),e0=n((e,{})=>()=>i(eD,{$title:"复制当前节点为 JSON 字符串",children:i(eb,{type:"button",onClick:()=>eZ(JSON.stringify(e.value,null,2)),children:i(Q,{path:er})})}),{displayName:"CopyAsJSONIconBtn",props:["value"]}),e1=n(({},{emit:e})=>()=>i(eD,{$title:"移除项",children:i(eb,{type:"button",onClick:()=>e("remove"),children:i(Q,{path:en})})}),{displayName:"ItemRemoveIconBtn",emits:["remove"]}),e2=n((e,{emit:t,render:n})=>{let l=s(null),o=ez.from(l),p=eF.from(l),c=e$.from(l),u=em.use(),y=()=>{l.value&&(l.value.value="",l.value.blur())},f=r=>{if(r??=o.value){let[n,a]=h.schemaProp(e.typedef,"items").validate(r,{coerce:!0});if(n)return void u.setError(e.ctx.path,n);t("add",a)}else t("add",void 0);y()};r(o,j(t=>{let r=t.trim();if(r.startsWith("[")&&r.endsWith("]"))try{let t=JSON.parse(r);u.update(e.ctx.path,t),y()}catch(t){u.setError(e.ctx.path,"无效的 JSON 字符串")}if(r.startsWith("{")&&r.endsWith("}"))try{f(JSON.parse(r))}catch(t){u.setError(e.ctx.path,"无效的 JSON 字符串")}}),d()),r(p,j(e=>{switch(e.type){case"COMMIT":f();break;case"CANCEL":y()}}),d());let m=r(c,n(e=>i(X,{isOpen:e,placement:"right-start",$content:a(eH,{children:[i(eb,{type:"button",onClick:()=>p.next({type:"CANCEL"}),children:i(Q,{path:ee})}),i(eb,{type:"button",onClick:()=>p.next({type:"COMMIT"}),children:i(Q,{path:et})})]}),children:i(eK,{children:i("input",{ref:l,type:"text",placeholder:"添加数组项 (可粘贴 JSON 字符串)"})})})));return()=>i(eG,{sx:{mx:-4},children:m})},{displayName:"ItemAddIconBtn",props:["ctx","typedef"],emits:["add"]});n(({},{emit:e})=>()=>i(eD,{$title:"删除属性",children:i(eb,{type:"button",onClick:()=>e("remove"),children:i(Q,{path:en})})}),{displayName:"PropRemoveIconBtn",emits:["remove"]});let e8=n((e,{emit:n,render:l})=>{let o=s(null),p=eF.from(o),c=ez.from(o),u=e$.from(o),y=em.use(),f=t.seed({index:0}),m=()=>{u.hide(),c.next(""),o.value&&(o.value.value="",o.value.blur()),f.next({index:0})};r(c,j(t=>{let r=t.trim();if(r.startsWith("{")&&r.endsWith("}"))try{let t=JSON.parse(r);y.update(e.ctx.path,t),m()}catch(t){y.setError(e.ctx.path,"无效的 JSON 字符串")}}),d());let x=t=>{e.options?t??=e.options[f.value.index%e.options.length]?.propName:t??=c.value,t?(n("add",t),m()):y.setError([...e.ctx.path,h.RecordKey],"无效的属性值")};r(p,j(e=>{switch(e.type){case"SELECT":f.next(t=>{t.index+=e.direction});break;case"COMMIT":x();break;case"CANCEL":m()}}),d());let v=r(u,l(e=>i(eK,{children:i("input",{ref:o,type:"text",placeholder:"添加属性 (可粘贴 JSON 字符串)","data-options":e})})));return r(_([c,u,f,e.options$]),l(([e,t,r,n])=>n?n.length>0?i(eG,{sx:{mx:-4},children:i(ek,{onSelected:e=>{x(e)},open$:u,$content:i("div",{children:n.map((t,a)=>e&&!t.propName.includes(e)?null:i(e3,{"data-focus":a===r.index%n.length,propName:t.propName,typedef:t.typedef}))}),children:v})}):null:i(eG,{sx:{mx:-4},children:i(X,{isOpen:t,placement:"right-start",$content:a(eH,{children:[i(eb,{type:"button",onClick:()=>p.next({type:"CANCEL"}),children:i(Q,{path:ee})}),i(eb,{type:"button",onClick:()=>p.next({type:"COMMIT"}),children:i(Q,{path:et})})]}),children:i(eK,{children:i("input",{ref:o,type:"text",placeholder:"添加属性 (可粘贴 JSON 字符串)"})})})})))},{displayName:"PropValueAddInput",props:["ctx","options"],emits:["add"]}),e3=c(e=>()=>a(e4,{"data-value":e.propName,tabindex:0,children:[i(eE,{optional:!!h.schemaProp(e.typedef,h.optional),children:e.propName}),i(eA,{children:h.metaProp(e.typedef,"title")})]}),{displayName:"PropMenuItem",props:["propName","typedef"]}),e4=V(eP,{displayName:"AddPropMenuItemContainer"})({[`& ${eE}`]:{textAlign:"left"}}),e5=n((e,{render:t})=>{let n=em.use(),l=ex.use(),o=r(e.n$,t(e=>i(ej,{children:e}))),s=v.create(e.ctx.path);return r(_([e.close$,e.value$,n.errorAt$(s),n.foldedPrefix$(s)]),t(([t,r,d,p])=>{let c=!!d,y=E(r)||"array"==e.typedef.type,f=!y&&A(r);if(t)return p?null:i(u,{children:i(e_,{"data-error":c,$leading:o,indent:e.ctx.path.length,children:y?a(u,{children:[a(ew,{children:["]","\xa0\xa0"]}),!e.ctx.readOnly&&i(e2,{ctx:e.ctx,typedef:e.typedef,onAdd:t=>{n.update(e.ctx.path,e=>{console.log(e),e.push(t)},[],e.typedef)}})]}):f?a(u,{children:[a(ew,{children:["}","\xa0\xa0"]}),!e.ctx.readOnly&&i(e8,{ctx:e.ctx,onAdd:t=>{n.update([...e.ctx.path,t],void 0)},options:"record"!=e.typedef.type?[...e.typedef.entries(r,e.ctx)].filter(([e])=>!Object.hasOwn(r,e)).map(([e,t,r])=>({propName:String(e),typedef:r})):void 0})]}):null})});if(p==eh.PREFIX)return null;let m=()=>{let t=O(e.ctx.path);return a(u,{children:[C(t)?null:i(eE,{deprecated:h.schemaProp(e.typedef,"deprecated"),$leading:e.ctx.readOnly?null:i(e1,{onRemove:()=>{n.delete(e.ctx.path)}}),children:i(q,{sx:I(t)?{opacity:1}:{opacity:.3,font:"code"},children:`${t}`})}),I(t)?i(ew,{children:": "}):e.ctx.path.length>0?i(ew,{children:"\xa0\xa0"}):null]})};return i(e_,{indent:e.ctx.path.length,"data-dirty":((e,t)=>{if(!(E(e)||A(e))){if(C(t)&&!C(e))return ey.ADD;if(!C(t)&&C(e))return ey.DELETE;if(!C(t)&&!C(e)&&e!==t)return ey.EDIT}return ey.NONE})(r,e.previous),"data-error":c,$leading:a(u,{children:[o,y||f?i(eB,{folded:p!==eh.NONE,onClick:()=>{n.toggleFold(s)}}):null]}),$comment:(()=>{let t=h.metaProp(e.typedef,"title"),r=h.metaProp(e.typedef,"description");return a(u,{children:[(t||r)&&i(eI,{children:r?i(eD,{$title:i(eA,{children:i(ei,{text:r})}),placement:"top",children:a("div",{children:[t," ",i(Q,{path:ea})]})}):i("span",{children:t})}),c&&i(eJ,{children:`${d}`})]})})(),children:(()=>{if(p){if(p==eh.EXACT){if(y)return a(u,{children:[m(),i(ew,{children:"[...]"})]});if(f)return a(u,{children:[m(),i(ew,{children:"{...}"})]})}return null}return a(u,{children:[m(),y?a(u,{children:[i(ew,{children:"["}),i(ev,{children:i(e0,{value:r})})]}):f?a(u,{children:[i(ew,{children:"{"}),i(ev,{children:i(e0,{value:r})})]}):l.$value?.(e.typedef,r,e.ctx)]})})()})}))},{displayName:"Line",props:["n","typedef","ctx","value","previous","close"]}),e6=(e,t,r)=>i(eX,{typedef:e,value:t,ctx:r}),e7=n((e,{render:t})=>{let n=em.use(),a=ex.use();return r(n,t(t=>i(eU,{children:i(ex,{value:{$value:a.$value??e6},children:i(e9,{children:i(te,{children:[...function* e(t,r,n,a){if("object"==n.type||"record"==n.type||"intersection"==n.type||"union"==n.type&&h.schemaProp(n,"discriminator")){let i={value:t??{},previous:r,typedef:n,ctx:a};for(let[t,l,o]of(yield i,n.entries(i.value,a)))Object.hasOwn(i.value,t)&&(yield*e(l,N(r,[t]),o,{...a,path:[...a.path,t],branch:[...a.branch,l]}));yield{...i,close:!0};return}if("union"==n.type&&C(h.schemaProp(n,"discriminator"))){let i=h.schemaProp(n,"oneOf");if(i?.length==2){let n=i.find(e=>"array"==e.type),l=i.find(e=>"array"!=e.type);if(n&&l&&h.schemaProp(n,"items").type==l.type){let i=el(t),l=el(r),o={value:i,previous:l,typedef:n,ctx:a};for(let[t,r,s]of(yield o,n.entries(i,a)))yield*e(r,N(l,[t]),s,{...a,path:[...a.path,t],branch:[...a.branch,r]});yield{...o,close:!0};return}}}if("array"==n.type){let i={value:t,previous:r,typedef:n,ctx:a};for(let[l,o,s]of(yield i,n.entries(t,a)))yield*e(o,N(r,[l]),s,{...a,path:[...a.path,l],branch:[...a.branch,o]});yield{...i,close:!0};return}if("any"==n.type||"unknown"==n.type){if(E(t))return void(yield*e(t,r,y(f()),a));if($(t))return void(yield*e(t,r,m(x(),f()),a))}yield{value:t,previous:r,typedef:n,ctx:a}}(t,n.initialsAt([]),n.typedef,{...w,readOnly:e.readOnly})].map((e,t)=>{let r=v.create(e.ctx.path);return i(e5,{n:t+1,ctx:e.ctx,typedef:e.typedef,value:e.value,previous:e.previous,close:e.close??!1},`${r}::${e.close??!1}`)})})})})})))},{displayName:"JSONEditorView",props:["readOnly"]}),e9=V("div",{displayName:"JSONEditorContainer"})({w:"100%",h:"100%",overflow:"auto"}),te=V("div",({},{slots:e})=>t=>i(t,{children:e.default()}),{displayName:"Lines"})({position:"relative",display:"flex",flexDirection:"column",w:"100%",maxW:"100%",py:2});export{ef as J,em as a,e7 as b,eZ as c};
